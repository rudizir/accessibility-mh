!function(e){"use strict";const t=MHACC_WIDGET_CONFIG.languages||{};const a={config:e.MHACC_WIDGET_CONFIG||{},design:{},features:{},init(){this.loadDesign(),this.loadFeatures(),this.loadUIState(),function(){if(document.getElementById("mhacc-widget-styles"))return;const e=document.createElement("style");e.id="mhacc-widget-styles",e.setAttribute("data-layer","free"),e.textContent=`\n            :root {\n                --mhacc_primarycolor:${a.design.widget_design.fields.theme_primary_color.value};\n                --mhacc_fontcolor:${a.design.widget_design.fields.theme_primary_fontcolor.value};\n            }\n            @keyframes triggerPulse {\n                0% {\n                    box-shadow: 0 0 0 0 ${a.design.widget_design.fields.theme_primary_color.value}90;\n                }\n                70% {\n                    box-shadow: 0 0 0 14px ${a.design.widget_design.fields.theme_primary_color.value}00;\n                }\n                100% {\n                    box-shadow: 0 0 0 0 ${a.design.widget_design.fields.theme_primary_color.value}00);\n                }\n            }\n            #mhacc-panel {\n                border-radius: ${a.design.widget_design.fields.border_radius.value}px;\n            }\n            #mhacc-panel[data-size="large"]{\n                ${a.design.trigger_design.fields.position_x.value.position}: 0;\n                bottom:0;\n            }\n            .mhacc-panel-group {\n                border-radius: ${a.design.widget_design.fields.border_radius.value}px;\n            }\n            #mhacc-trigger[data-positionx="right"]{\n               right:${a.design.trigger_design.fields.position_x.value.value}${a.design.trigger_design.fields.position_x.value.unit};\n            }\n            #mhacc-trigger[data-positionx="left"]{\n                left:${a.design.trigger_design.fields.position_x.value.value}${a.design.trigger_design.fields.position_x.value.unit};\n            }\n            /* TRIGGER Y-POSITION */\n            #mhacc-trigger[data-positiony="top"]{\n                top:${a.design.trigger_design.fields.position_y.value.value}${a.design.trigger_design.fields.position_y.value.unit};\n            }\n            #mhacc-trigger[data-positiony="bottom"]{\n                bottom:${a.design.trigger_design.fields.position_y.value.value}${a.design.trigger_design.fields.position_y.value.unit};\n            }\n        `,document.head.appendChild(e)}(),this.ui.mount(),this.applyUIState(),this.featuresRenderer.render(this.features),a.applyTranslations(),this.dispatchReady(),this.applyFeatures(),this.applyFeatureEffects(),document.querySelectorAll(i).forEach((t=>{if(!a.isInsidePanel(t)){if(t.dataset.mhaccFontBase||(t.dataset.mhaccFontBase=parseFloat(e.getComputedStyle(t).fontSize)),!t.dataset.mhaccLineBase){const a=e.getComputedStyle(t).lineHeight;t.dataset.mhaccLineBase="normal"===a?1.2*parseFloat(e.getComputedStyle(t).fontSize):parseFloat(a)}if(!t.dataset.mhaccSpacingBase){const a=e.getComputedStyle(t).letterSpacing;t.dataset.mhaccSpacingBase="normal"!==a?parseFloat(a):0}}})),this.keyboard.init()},loadDesign(){this.design=this.config.settings?.design||{}},loadFeatures(){const e=this.config.settings?.features||{},t=a.storage.load();this.features=structuredClone(e),Object.entries(this.features).forEach((([e,a])=>{Object.entries(a.fields||{}).forEach((([e,a])=>{a.value=a.value??a.default??0,void 0!==t[e]&&(a.value=t[e])}))}))},dispatchReady(){document.dispatchEvent(new CustomEvent("mhacc:ready",{detail:this}))}},n=a.config.icons||{};a.debugState=function(){console.table(Object.values(a.features).flatMap((e=>Object.entries(e.fields).map((([e,t])=>({feature:e,value:t.value}))))))},a.storage={KEY:"mhacc_widget_user_settings",load(){try{return JSON.parse(localStorage.getItem(this.KEY))||{}}catch(e){return{}}},save(e){localStorage.setItem(this.KEY,JSON.stringify(e))},set(e,t){const a=this.load();a[e]=t,this.save(a)},get(e,t=null){return this.load()?.[e]??t},remove(e){const t=this.load();delete t[e],this.save(t)},clear(){localStorage.removeItem(this.KEY)}},document.addEventListener("click",(e=>{e.target.closest('[data-action="mhacc_storage_reset"]')&&(console.log("RESET CLICK"),a.storage.clear(),Object.values(a.features).forEach((e=>{e?.fields&&Object.entries(e.fields).forEach((([e,t])=>{"toggle"===t.type&&(t.value=t.default??!1),"slider"===t.type&&(t.value=t.jsdefault??100),"select"===t.type&&(t.value=t.jsdefault??null)}))})),a.featureEffects.font_size(100),a.featureEffects.line_height(100),a.featureEffects.letter_spacing(100),document.querySelectorAll(".mhacc-feature-btn, .mhacc-feature-btn-select, .select-data-wrap-item").forEach((e=>{e.classList.remove("is-active")})),document.querySelectorAll(".mhacc-feature-btn-slider").forEach((e=>{const t=e.querySelector(".mhacc-slider-value");t&&(t.textContent=100)})),document.body.className=document.body.className.split(" ").filter((e=>!e.startsWith("mhacc--"))).join(" "),a.removeFontSize(),a.removeLineHeight(),a.removeLetterSpacing(),a.applyFeatures(),a.applyFeatureEffects(),document.dispatchEvent(new CustomEvent("mhacc:reset")))})),a.i18n={lang:MHACC_WIDGET_CONFIG.lang||"en",get dict(){return MHACC_WIDGET_CONFIG.languages?.[this.lang]?.translations||MHACC_WIDGET_CONFIG.languages?.en?.translations||{}},t(e,t=""){return this.dict[e]??t??e},tGroup(e,t,a=""){return this.dict.groups?.[e]?.[t]??a??`${e}.${t}`}},a.ui={mount(){document.getElementById("mhacc-panel")||(document.body.appendChild(this.buildPanel()),this.bindPanelActions()),document.getElementById("mhacc-trigger")||document.body.appendChild(this.buildTrigger())},buildPanel(){const e=document.createElement("nav");e.id="mhacc-panel";const i=a.design?.widget_design?.fields||{},s=a.design?.trigger_design?.fields||{};e.dataset.style=i.widget_style?.value||"style_1",e.dataset.size=i.widget_size?.value||"medium",e.dataset.mode=i.theme_mode?.value||"light",e.dataset.positionx=s.position_x?.value?.position||"right";const o=document.createElement("div");o.classList.add("mhacc-langmenu-wrap"),t&&"object"==typeof t&&Object.entries(t).forEach((([e,t])=>{const n=document.createElement("button");n.type="button",n.classList.add("mhacc-langmenu-item"),n.dataset.lang=e,n.dataset.action="change_lang",n.textContent=t.title,e===a.uiState.lang&&n.classList.add("is-active"),o.appendChild(n)})),e.innerHTML=`\n                <div id="mhacc-panel-header">\n                    <div id="mhacc-panel-header-first">\n                        \n                            <strong id="mhacc-panel-title" data-i18n="title" >${a.i18n.t("title")}</strong>\n\n                        \n                            <button aria-label="Open Languages Menue" id="btn_mhacc_toogle_lang" data-action="toogle_lang">\n                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">\n                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"></path>\n                                </svg>\n                                <div id="lang_items"></div>\n                            </button>\n                \n                            \n                            <button aria-label="Open User Options" data-action="toogle_user_options">\n                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">\n                                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.398.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.272-.806.108-1.204-.165-.397-.506-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.108-1.204l-.526-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z"></path>\n                                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path>\n                                </svg>\n                            </button>\n\n                            <button id="mhacc-help-btn" aria-label="Hilfe und Informationen öffnen" data-action="open_help" title="Hilfe / Tastaturbefehle">\n                                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n                                    <circle cx="8" cy="8" r="7" stroke="currentColor" fill="none"/>\n                                    <path d="M6.5 6.2c0-1 .8-1.6 1.6-1.6.9 0 1.7.6 1.7 1.6 0 .9-.6 1.3-1.2 1.7-.5.3-.8.7-.8 1.2v.3" \n                                        stroke="currentColor" fill="none" stroke-linecap="round"/>\n                                    <circle cx="8" cy="11.3" r=".8" fill="currentColor"/>\n                                </svg>\n                            </button>\n\n                            <button aria-label="Widget close" data-action="close">${n["icon-close"]}</button>\n                        \n                    </div>\n                    <div id="user_options">\n\n                        <div id="set_panel_light_dark" class="user_option_wrap">\n                            <button type="button" role="button" aria-label="Change Widgetstyle to light" data-action="change_mode" data-value="light"> ${n["icon-sun"]} </button>\n                            <button type="button" role="button" aria-label="Change Widgetstyle to dark" data-action="change_mode" data-value="dark"> ${n["icon-moon"]} </button>\n                        </div>\n\n                        <div id="set_panel_left_right" class="user_option_wrap">\n                            <button type="button" role="button" aria-label="Change Widgetposition to left" data-action="change_widget_positionx" data-value="left"> ${n["icon-position-left"]} </button>\n                            <button type="button" role="button" aria-label="Change Widgetposition to right" data-action="change_widget_positionx" data-value="right"> ${n["icon-position-right"]} </button>\n                        </div>\n\n                        <div id="set_panel_size" class="user_option_wrap">\n                            <button type="button" role="button" aria-label="Change Widgetsize to small" data-action="change_widget_size" data-value="small"> ${n["icon-widget-small"]} </button>\n                            <button type="button" role="button" aria-label="Change Widgetsize to medium" data-action="change_widget_size" data-value="medium"> ${n["icon-widget-medium"]} </button>\n                            <button type="button" role="button" aria-label="Change Widgetsize to large" data-action="change_widget_size" data-value="large"> ${n["icon-widget-large"]} </button>\n                        </div>\n\n                        <div id="set_panel_style" class="user_option_wrap">\n                            <button type="button" role="button" aria-label="Change Widgetstyle to gridview" data-action="change_widget_style" data-value="style_1"> ${n["icon-style_1"]} </button>\n                            <button type="button" role="button" aria-label="Change Widgetstyle to listview" data-action="change_widget_style" data-value="style_2"> ${n["icon-style_2"]} </button>\n                        </div>\n\n                    </div>\n                </div>\n\n                <div id="mhacc-panel-features"></div>\n\n                <div id="mhacc-panel-footer">\n                    \n                    <div id="mhacc-misc-wrap">\n                        <button id="mhacc-misc" data-action="mhacc_storage_reset" type="button" role="button" aria-label="Widget Reset"><span id="mhacc-misc-text" data-i18n="misc">${a.i18n.t("misc")}</span></button>\n                    </div>\n\n                    <div id="mhacc-panel-footer-last">\n                        ${""!==a.design.general.fields.accessibility_statement_url.value?`<a id="mhacc_accessibility_link" href="${a.design.general.fields.accessibility_statement_url.value}" rel="noopener">\n                                <span id="mhacc-statement" data-i18n="statement">${a.i18n.t("statement")}</span>\n                            </a>`:""}\n                        ${1!==Number(a?.design?.widget_design?.fields?.remove_branding?.value)?'\n                                    <span id="powered_by_text">\n                                        <a href="https://mh-accessibility.de" target="_blank" rel="noopener">\n                                            MH-ACCESSIBILITY.DE\n                                        </a>\n                                    </span>\n                                ':""}\n                    </div>\n                </div>\n            `;const l=e.querySelector("#lang_items");return l&&o&&l.appendChild(o),e},buildTrigger(){const e=document.createElement("button");e.id="mhacc-trigger";a.design;const t=a.design?.trigger_design?.fields||{};e.setAttribute("aria-label","Open accessibility menu"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-controls","mhacc-panel"),e.title="Open accessibility menu",e.type="button",e.role="button",e.dataset.style=t.trigger_icon_style?.value||"style_2",e.dataset.size=t.trigger_icon_size?.value||"medium",e.dataset.positionx=t.position_x?.value?.position||"right",e.dataset.positiony=t.position_y?.value?.position||"bottom";const i=t.trigger_icon?.value||"icon-1",s=n[i]||n["icon-1"];e.innerHTML=`\n                <span class="mhacc-trigger-icon" aria-hidden="true">\n                    ${s}\n                </span>\n            `;const o=document.getElementById("mhacc-panel");function l(){if(!o)return;const t=o.classList.toggle("is-open");e.setAttribute("aria-expanded",t)}return e.addEventListener("click",l),e.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),l())})),e}},a.toggleFeature=function(e,t,n=null){const i=a.features?.[e]?.fields?.[t];if(!i||"toggle"!==i.type)return;const s=!i.value;i.value=s,a.storage.set(t,s),n&&(n.classList.toggle("is-active",i.value),n.setAttribute("aria-pressed",i.value?"true":"false")),document.dispatchEvent(new CustomEvent("mhacc:feature",{detail:{group:e,key:t,value:i.value}}))},a._toggleFeatureBase||(a._toggleFeatureBase=a.toggleFeature),a.changeSlider=function(e,t,n,i){const s=a.features?.[e]?.fields?.[t];if(!s||"slider"!==s.type)return;const o=s.jsmin??0,l=s.jsmax??200;let c=s.value+n;c=Math.min(l,Math.max(o,c)),s.value=c,a.storage.set(t,c),i&&(i.textContent=c),document.dispatchEvent(new CustomEvent("mhacc:feature",{detail:{group:e,key:t,value:c}}))},a.selectFeature=function(e,t,n,i){const s=a.features?.[e]?.fields?.[t];s&&"select"===s.type&&(s.value=n,a.storage.set(t,n),i.querySelectorAll(".select-data-wrap-item").forEach((e=>e.classList.remove("is-active"))),i.querySelector(`[data-select="${n}"]`)?.classList.add("is-active"),document.dispatchEvent(new CustomEvent("mhacc:feature",{detail:{group:e,key:t,value:n}})))},a.cycleSelectFeature=function(e,t){const n=a.features?.[e]?.fields?.[t];if(!n||"select"!==n.type)return;const i=n.jsoptions||[];if(!i.length)return;const s=i.indexOf(n.value);let o;o=-1===s?i[0]:s===i.length-1?null:i[s+1],n.value=o,a.storage.set(t,o);const l=document.querySelector(`.mhacc-feature-btn-select[data-group="${e}"]`);if(l&&(l.querySelectorAll(".select-data-wrap-item").forEach((e=>e.classList.remove("is-active"))),null!==o)){const e=l.querySelector(`.select-data-wrap-item[data-select="${o}"]`);e?.classList.add("is-active")}document.dispatchEvent(new CustomEvent("mhacc:feature",{detail:{group:e,key:t,value:o}}))},a.applyFeatures=function(){const e=document.body;e.className=e.className.split(" ").filter((e=>!e.startsWith("mhacc--"))).join(" "),Object.values(a.features).forEach((t=>{t?.fields&&Object.entries(t.fields).forEach((([t,a])=>{"toggle"===a.type&&!0===a.value&&e.classList.add(`mhacc--${t}`),"slider"===a.type&&e.classList.add(`mhacc--${t}-${a.value}`),"select"===a.type&&e.classList.add(`mhacc--${t}-${a.value}`)}))}))},a.uiState={mode:"light",size:"medium",style:"style_1",positionx:"right",lang:"en"},a.storage.KEY_FEATURES="mhacc_widget_user_settings",a.storage.KEY_UI="mhacc_widget_ui_settings",a.loadUIState=function(){const e=JSON.parse(localStorage.getItem(a.storage.KEY_UI)||"{}");a.uiState={mode:e.mode??a.design.widget_design.fields.theme_mode.value,size:e.size??a.design.widget_design.fields.widget_size.value,style:e.style??a.design.widget_design.fields.widget_style.value,positionx:e.positionx??a.design.trigger_design.fields.position_x.value.position,lang:e.lang??a.i18n.lang},a.i18n.lang=a.uiState.lang},a.applyUIState=function(){const e=document.getElementById("mhacc-panel"),t=document.getElementById("mhacc-trigger");if(!e)return;e.dataset.mode=a.uiState.mode,e.dataset.size=a.uiState.size,e.dataset.style=a.uiState.style,e.dataset.positionx=a.uiState.positionx,t&&(t.dataset.positionx=a.uiState.positionx);Object.entries({change_mode:"mode",change_widget_size:"size",change_widget_style:"style",change_widget_positionx:"positionx"}).forEach((([t,n])=>{e.querySelectorAll(`[data-action="${t}"]`).forEach((e=>{e.classList.toggle("is-active",e.dataset.value===a.uiState[n])}))}))},a.saveUIState=function(){localStorage.setItem(a.storage.KEY_UI,JSON.stringify(a.uiState))};const i="\n    p, span, a, li,\n    h1, h2, h3, h4, h5, h6,\n    label, small, strong, em,\n    blockquote, figcaption,\n    td, th,\n    button, input, textarea,\n    summary, legend\n    ",s=document.createElement("div");s.id="mhacc-reading-line",document.body.appendChild(s);const o=document.createElement("div");o.id="mhacc-reading-mask",document.body.appendChild(o),document.addEventListener("mousemove",(e=>{if(document.body.classList.contains("mhacc--reading-line")?(s.style.display="block",s.style.top=e.clientY+"px"):s.style.display="none",document.body.classList.contains("mhacc--reading-mask")){o.style.display="block";const t=160;o.style.top=e.clientY-t/2+"px"}else o.style.display="none"})),a.isInsidePanel=function(e){return e.closest("#mhacc-panel")},a.isIgnoredTextElement=function(e){return e.closest("svg, i, .icon")},a.removeFontSize=function(){document.querySelectorAll(i).forEach((e=>{a.isInsidePanel(e)||(e.dataset.mhaccFontBase?e.style.setProperty("font-size",e.dataset.mhaccFontBase+"px","important"):e.style.removeProperty("font-size"))}))},a.removeLineHeight=function(){document.querySelectorAll(i).forEach((e=>{a.isInsidePanel(e)||(e.dataset.mhaccLineBase?e.style.setProperty("line-height",e.dataset.mhaccLineBase+"px","important"):e.style.removeProperty("line-height"))}))},a.removeLetterSpacing=function(){document.querySelectorAll(i).forEach((e=>{a.isInsidePanel(e)||(e.dataset.mhaccSpacingBase?e.style.setProperty("letter-spacing",e.dataset.mhaccSpacingBase+"px","important"):e.style.removeProperty("letter-spacing"))}))},a.enableBigCursor=function(){const e=encodeURIComponent('\n        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">\n        <path fill="black" stroke="white" stroke-width="3"\n                d="M2.4 2.4 L43.2 14.4 L31.2 24 L45.6 38.4 L38.4 45.6 L24 31.2 L14.4 43.2 Z"/>\n        </svg>').replace(/'/g,"%27").replace(/"/g,"%22");document.body.style.cursor=`url("data:image/svg+xml,${e}") 0 0, default`},a.disableBigCursor=function(){document.body.style.cursor=""},a.featureEffects={reading_line(e){document.body.classList.toggle("mhacc--reading-line",e)},reading_mask(e){document.body.classList.toggle("mhacc--reading-mask",e)},stop_animations(e){document.body.classList.toggle("mhacc--stop-animations",e),document.querySelectorAll("svg").forEach((t=>{t&&(e&&"function"==typeof t.pauseAnimations&&t.pauseAnimations(),e||"function"!=typeof t.unpauseAnimations||t.unpauseAnimations())}))},big_cursor(e){document.body.classList.toggle("mhacc--big-cursor",e),e?a.enableBigCursor():a.disableBigCursor()},font_size(t){if(!t||100===t)return void a.removeFontSize();const n=t/100;document.querySelectorAll(i).forEach((t=>{if(a.isInsidePanel(t))return;if(a.isIgnoredTextElement(t))return;const i=e.getComputedStyle(t),s=parseFloat(i.fontSize);s&&!isNaN(s)&&(t.dataset.mhaccFontBase||(t.dataset.mhaccFontBase=s),t.style.setProperty("font-size",t.dataset.mhaccFontBase*n+"px","important"))}))},line_height(t){if(!t||100===t)return void a.removeLineHeight();const n=t/100;document.querySelectorAll(i).forEach((t=>{if(a.isInsidePanel(t))return;if(a.isIgnoredTextElement(t))return;const i=e.getComputedStyle(t);let s;if("normal"===i.lineHeight){const e=parseFloat(i.fontSize);if(!e)return;s=1.2*e}else s=parseFloat(i.lineHeight);s&&!isNaN(s)&&(t.dataset.mhaccLineBase||(t.dataset.mhaccLineBase=s),t.style.setProperty("line-height",t.dataset.mhaccLineBase*n+"px","important"))}))},letter_spacing(t){if(!t||100===t)return void a.removeLetterSpacing();const n=(t-100)/100;document.querySelectorAll(i).forEach((t=>{if(a.isInsidePanel(t))return;if(a.isIgnoredTextElement(t))return;const i=e.getComputedStyle(t),s=parseFloat(i.fontSize);if(!s||isNaN(s))return;const o="normal"!==i.letterSpacing?parseFloat(i.letterSpacing):0;t.dataset.mhaccSpacingBase||(t.dataset.mhaccSpacingBase=o);const l=.05*s*n;t.style.setProperty("letter-spacing",(parseFloat(t.dataset.mhaccSpacingBase)+l).toFixed(2)+"px","important")}))}},a.applyFeatureEffects=function(){Object.values(a.features).forEach((e=>{e&&e.fields&&Object.entries(e.fields).forEach((([e,t])=>{const n=a.featureEffects[e];n&&n(t.value)}))}))},a.ui.bindPanelActions=function(){const e=document.getElementById("mhacc-panel");if(!e)return;const t=e.querySelector("#user_options"),n=e.querySelector("#lang_items");e.addEventListener("click",(i=>{const s=i.target.closest("[data-action]");if(!s||!e.contains(s))return;const o=s.dataset.action,l=s.dataset.value,c=s.dataset.lang;switch(o){case"toogle_user_options":t?.classList.toggle("is-open"),n?.classList.remove("is-open");break;case"toogle_lang":n?.classList.toggle("is-open"),t?.classList.remove("is-open");break;case"open_help":const i=document.getElementById("mhacc-help-panel");i&&"flex"===i.style.display?i.style.display="none":a.help.open();break;case"close":e.classList.remove("is-open"),t?.classList.remove("is-open"),n?.classList.remove("is-open");const o=document.getElementById("mhacc-trigger");o&&o.setAttribute("aria-expanded","false");break;case"toggle_feature":{const e=s.dataset.feature,t=s.dataset.group;a.toggleFeature(t,e,s);break}case"slider_change":{const e=s.dataset.group,t=s.dataset.feature,n=Number(s.dataset.delta),i=s.closest(".mhacc-feature-btn-slider")?.querySelector(".mhacc-slider-value");a.changeSlider(e,t,n,i);break}case"select_option":{const e=s.dataset.group,t=s.dataset.feature,n=s.dataset.select,i=s.closest(".mhacc-feature-btn-select");a.selectFeature(e,t,n,i);break}case"cycle_select":{const e=s.dataset.group,t=s.dataset.feature;a.cycleSelectFeature(e,t);break}case"change_mode":a.uiState.mode=l,a.saveUIState(),a.applyUIState();break;case"change_widget_size":a.uiState.size=l,a.saveUIState(),a.applyUIState();break;case"change_widget_style":a.uiState.style=l,a.saveUIState(),a.applyUIState();break;case"change_widget_positionx":a.uiState.positionx=l,a.saveUIState(),a.applyUIState();break;case"change_lang":a.uiState.lang=c,a.i18n.lang=c,a.saveUIState(),a.applyTranslations(),e.querySelectorAll(".mhacc-langmenu-item").forEach((e=>e.classList.toggle("is-active",e.dataset.lang===c)))}})),document.addEventListener("click",(a=>{const i=document.getElementById("mhacc-trigger");e.contains(a.target)||a.target===i||i.contains(a.target)||(t?.classList.remove("is-open"),n?.classList.remove("is-open"),e.classList.contains("is-open")&&(e.classList.remove("is-open"),i.classList.remove("is-active"),i.setAttribute("aria-expanded","false"),document.dispatchEvent(new CustomEvent("mhacc:panelClosed"))))}))},a.help={open(){let e=document.getElementById("mhacc-help-panel");if(!e){e=document.createElement("div"),e.id="mhacc-help-panel",e.className="mhacc-panel mhacc-help";const t=a.i18n.t("shortcuttitle","Shortcuts");e.innerHTML=`\n                <div id="mhacc-help-header">\n                    <h2>${t}</h2>\n                    <button id="mhacc-help-close" aria-label="Close help panel">\n                        <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n                            <g fill="currentColor" fill-rule="nonzero">\n                                <path d="M1.084 1.791a.5.5 0 1 1 .707-.707l13.125 13.125a.5.5 0 0 1-.707.707L1.084 1.791Z"></path>\n                                <path d="M14.916 1.791a.5.5 0 1 0-.707-.707L1.084 14.209a.5.5 0 0 0 .707.707L14.916 1.791Z"></path>\n                            </g>\n                        </svg>\n                    </button>\n                </div>\n\n                \x3c!-- HINWEIS ZUR TASTATURNAVIGATION --\x3e\n                <div id="mhacc-help-notice" class="mhacc-help-notice" role="note" aria-live="polite"></div>\n\n                <div id="mhacc-help-table-wrap">\n                    <table id="mhacc-help-table">\n                        <tbody></tbody>\n                    </table>\n                </div>\n            `,document.body.appendChild(e),document.getElementById("mhacc-help-close").addEventListener("click",(()=>e.remove()))}const t=e.querySelector("#mhacc-help-notice"),n=document.body.classList.contains("mhacc--keyboard_navigation");t.innerHTML=n?a.i18n.t("shortcutnote_active","✓ Tastaturnavigation ist aktiv."):a.i18n.t("shortcutnote_inactive","Diese Shortcuts funktionieren nur bei aktivierter Tastaturnavigation (Alt + K).");const i=e.querySelector("tbody");i.innerHTML="";const s=a.i18n.dict?.hotkeys||{};if(Object.keys(s).length){const e=e=>({alt:"Alt",ctrl:"Strg",shift:"Shift",enter:"Enter",tab:"Tab",esc:"Esc",space:"Space"}[e.toLowerCase()]||e.toUpperCase());for(const[t,a]of Object.entries(s)){const n=document.createElement("tr"),s=document.createElement("td"),o=document.createElement("td"),l=t.split("_").map(e);s.innerHTML=l.map((e=>`<kbd>${e}</kbd>`)).join(" + "),o.textContent=a,n.appendChild(s),n.appendChild(o),i.appendChild(n)}}else{const e=document.createElement("tr"),t=document.createElement("td");t.colSpan=2,t.textContent=a.i18n.t("no_shortcuts","No shortcuts defined for this language."),e.appendChild(t),i.appendChild(e)}e.style.display="flex",e.focus()}},a.keyboard={init(){this.bindGlobalKeys(),this.bindPanelKeys()},triggerSlider(t,a,n){const i=document.querySelector(`.mhacc-slider-btn[data-feature="${a}"][data-group="${t}"][data-delta="${n}"]`);i?.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:e}))},triggerToggle(t){const a=document.querySelector(t);a?.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:e}))},isEnabled:()=>document.body.classList.contains("mhacc--keyboard_navigation"),getFocusable:e=>[...e.querySelectorAll('button, [href], input, select, textarea, [tabindex="0"]')].filter((e=>!e.disabled&&null!==e.offsetParent)),bindGlobalKeys(){document.addEventListener("keydown",(t=>{const n=document.getElementById("mhacc-panel"),i=document.getElementById("mhacc-trigger");if(t.altKey&&"KeyK"===t.code)return t.preventDefault(),void this.triggerToggle('.mhacc-feature-btn[data-feature="keyboard_navigation"][data-group="orientierung_navigation"]');if(!this.isEnabled())return;if(t.altKey&&"Digit9"===t.code){t.preventDefault();const e=document.getElementById("mhacc-help-panel");return void(e&&"flex"===e.style.display?e.style.display="none":a.help.open())}if(t.ctrlKey&&t.shiftKey&&"KeyA"===t.code){t.preventDefault();const e=document.getElementById("mhacc-panel"),a=document.getElementById("mhacc-trigger");return e?.classList.contains("is-open")||a?.click(),void setTimeout((()=>this.focusFirst()),50)}if(t.altKey&&"KeyN"===t.code){t.preventDefault();const e=document.querySelector("nav, #nav, #navigation");return void(e&&(e.setAttribute("tabindex","-1"),e.focus(),e.scrollIntoView({behavior:"smooth"})))}if(t.altKey&&"KeyS"===t.code){t.preventDefault();const e=document.querySelector("main");return void(e&&(e.setAttribute("tabindex","-1"),e.focus(),e.scrollIntoView({behavior:"smooth"})))}if(t.altKey&&"ArrowLeft"===t.code)return t.preventDefault(),void history.back();if(t.altKey&&"ArrowRight"===t.code)return t.preventDefault(),void history.forward();if(t.altKey&&"Digit1"===t.code)return t.preventDefault(),i?.click(),void setTimeout((()=>{this.focusFirst()}),50);if(t.altKey&&"Digit0"===t.code){t.preventDefault();const a=document.getElementById("mhacc-misc");return void a?.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:e}))}const s={KeyL:["inhaltsmodule","highlight_links"],KeyH:["inhaltsmodule","highlight_title"],KeyF:["inhaltsmodule","focus"],KeyV:["inhaltsmodule","stop_autoplay"],KeyP:["inhaltsmodule","tts"],KeyD:["visuelle_module","dark_mode"],KeyC:["visuelle_module","high_contrast"],KeyR:["orientierung_navigation","reading_line"],KeyI:["orientierung_navigation","hide_images"],KeyO:["orientierung_navigation","stop_animations"]};if(t.altKey&&s[t.code]){t.preventDefault();const[e,a]=s[t.code];return void this.triggerToggle(`.mhacc-feature-btn[data-feature="${a}"][data-group="${e}"]`)}if(t.altKey&&"KeyB"===t.code){t.preventDefault();const e=document.querySelector('.mhacc-feature-btn-select[data-feature="blind_filters"][data-group="visuelle_module"]');return void e?.click()}if(t.altKey&&"KeyT"===t.code)return t.preventDefault(),this.triggerSlider("inhaltsmodule","font_size",10),this.triggerSlider("inhaltsmodule","line_height",10),void this.triggerSlider("inhaltsmodule","letter_spacing",10);if(t.altKey&&"KeyG"===t.code)return t.preventDefault(),this.triggerSlider("inhaltsmodule","font_size",-10),this.triggerSlider("inhaltsmodule","line_height",-10),void this.triggerSlider("inhaltsmodule","letter_spacing",-10);const o={h:"h1,h2,h3,h4,h5,h6",a:"a[href]",l:"ul,ol",b:"button",f:"input,textarea,select",i:"img"}[t.key.toLowerCase()];if(!o)return;const l=document.activeElement.tagName.toLowerCase();if(["input","textarea","select"].includes(l))return;t.preventDefault();const c=Array.from(document.querySelectorAll(o)).filter((e=>null!==e.offsetParent));if(!c.length)return;const r=document.activeElement;let d=null;const u=t.shiftKey;if(u)for(let e=c.length-1;e>=0;e--){const t=c[e];if(r.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING){d=t;break}}else for(const e of c)if(r.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING){d=e;break}d||(d=u?c[c.length-1]:c[0]);const g=d.tagName.toLowerCase();["a","button","input","select","textarea"].includes(g)||d.hasAttribute("tabindex")||d.setAttribute("tabindex","0"),d.scrollIntoView({behavior:"smooth",block:"center"}),d.focus({preventScroll:!0}),"Escape"===t.key&&n?.classList.contains("is-open")&&(t.preventDefault(),this.closePanel())}))},bindPanelKeys(){const e=document.getElementById("mhacc-panel");e&&e.addEventListener("keydown",(t=>{if(!this.isEnabled())return;const a=this.getFocusable(e),n=document.activeElement,i=a.indexOf(n);if("Tab"===t.key)return void(t.shiftKey?0===i&&(t.preventDefault(),a[a.length-1]?.focus()):i===a.length-1&&(t.preventDefault(),a[0]?.focus()));const s=n.closest("[data-action]");if(!s)return;switch(s.dataset.action){case"toggle_feature":["Enter"," "].includes(t.key)&&(t.preventDefault(),s.click());break;case"slider_change":this.handleSliderKeys(t,s);break;case"cycle_select":["Enter"," "].includes(t.key)&&(t.preventDefault(),s.click()),["ArrowRight","ArrowLeft"].includes(t.key)&&(t.preventDefault(),s.click())}}))},handleSliderKeys(e,t){const a=t.closest(".mhacc-feature-btn-slider");if(!a)return;const n=a.querySelector('[data-delta="-10"]'),i=a.querySelector('[data-delta="10"]');switch(e.key){case"ArrowLeft":case"ArrowDown":e.preventDefault(),n?.click();break;case"ArrowRight":case"ArrowUp":e.preventDefault(),i?.click();break;case"Home":e.preventDefault(),this.setSliderToMin(a);break;case"End":e.preventDefault(),this.setSliderToMax(a)}},setSliderToMin(e){const t=e.querySelector('[data-delta="-10"]');for(let e=0;e<20;e++)t?.click()},setSliderToMax(e){const t=e.querySelector('[data-delta="10"]');for(let e=0;e<20;e++)t?.click()},focusFirst(){const e=document.getElementById("mhacc-panel");if(!e)return;const t=this.getFocusable(e);t[0]?.focus()},closePanel(){const e=document.getElementById("mhacc-panel"),t=document.getElementById("mhacc-trigger");e?.classList.remove("is-open"),t?.setAttribute("aria-expanded","false"),t?.focus()}},a.applyTranslations=function(){const e=document.getElementById("mhacc-panel");if(!e)return;e.querySelectorAll("[data-i18n]").forEach((e=>{const t=e.dataset.i18n;e.textContent=a.i18n.t(t,e.textContent)})),e.querySelectorAll("[data-i18n-group]").forEach((e=>{const t=e.dataset.i18nGroup,n=e.dataset.i18nProp;e.textContent=a.i18n.tGroup(t,n,e.textContent)})),e.querySelectorAll("[data-feature]").forEach((e=>{const t=e.dataset.feature,n=a.i18n.t(t);n&&(e.setAttribute("aria-label",n),e.setAttribute("title",n))}));const t=document.getElementById("mhacc-help-panel");if(t){const e=t.querySelector("tbody");if(e){e.innerHTML="";const n=a.i18n.dict?.hotkeys||{},i=e=>({alt:"Alt",ctrl:"Strg",shift:"Shift",enter:"Enter",tab:"Tab",esc:"Esc",space:"Space"}[e.toLowerCase()]||e.toUpperCase());if(Object.keys(n).length)for(const[t,a]of Object.entries(n)){const n=document.createElement("tr"),s=document.createElement("td"),o=document.createElement("td"),l=t.split("_").map(i);s.innerHTML=l.map((e=>`<kbd>${e}</kbd>`)).join(" + "),o.textContent=a,n.appendChild(s),n.appendChild(o),e.appendChild(n)}else{const t=document.createElement("tr"),n=document.createElement("td");n.colSpan=2,n.textContent=a.i18n.t("no_shortcuts","No shortcuts defined for this language."),t.appendChild(n),e.appendChild(t)}const s=t.querySelector("#mhacc-help-header h2");s&&(s.textContent=a.i18n.t("shortcuttitle","Shortcuts"));const o=t.querySelector("thead");o&&(o.querySelectorAll("th")[0].textContent=a.i18n.t("shortcut","Shortcut"),o.querySelectorAll("th")[1].textContent=a.i18n.t("description","Beschreibung"))}}const n=e.querySelector(".mhacc-lang-label");n&&(n.textContent=MHACC_WIDGET_CONFIG.languages?.[a.i18n.lang]?.title||a.i18n.lang)},a.featuresRenderer={render(e){const t=document.getElementById("mhacc-panel-features");t&&e&&(t.innerHTML="",Object.values(e).forEach((e=>{if(!e||!e.fields)return;const n=document.createElement("section");n.className="mhacc-panel-group",n.id=`mhacc-group-${e.id}`;const i=document.createElement("div");if(i.className="mhacc-panel-group-header",e.title){const t=document.createElement("p");t.className="mhacc-group-title",t.setAttribute("data-i18n-group",e.id),t.setAttribute("data-i18n-prop","title"),t.textContent=a.i18n.tGroup(e.id,"title"),i.appendChild(t)}if(e.description){const t=document.createElement("p");t.className="mhacc-group-description",t.setAttribute("data-i18n-group",e.id),t.setAttribute("data-i18n-prop","description"),t.textContent=a.i18n.tGroup(e.id,"description"),i.appendChild(t)}const s=document.createElement("div");s.className="mhacc-panel-group-features",Object.entries(e.fields).forEach((([t,n])=>{if(n)if("toggle"===n.type){const i=document.createElement("button");i.type="button",i.className="mhacc-feature-btn",i.dataset.action="toggle_feature",i.dataset.feature=t,i.dataset.group=e.id,i.role="button",i.ariaLabel=n.label||t,i.setAttribute("aria-pressed",n.value?"true":"false"),i.title=n.label||t,n.value&&i.classList.add("is-active"),t.startsWith("profile_")&&i.classList.add("mhacc-profile-btn");const o=document.createElement("span");o.className="mhacc-btn-icon",o.innerHTML=n.icon;const l=document.createElement("span");l.className="mhacc-btn-label",l.dataset.i18n=t,l.textContent=a.i18n.t(t,n.label);const c=document.createElement("span");c.classList.add("fake-toggle"),i.appendChild(o),i.appendChild(l),i.appendChild(c),s.appendChild(i)}else if("slider"==n.type){const i=document.createElement("div");i.className="mhacc-feature-btn-slider";const o=document.createElement("span");o.classList.add("mhacc-btn-icon"),o.innerHTML=n.icon;const l=document.createElement("span");l.className="mhacc-btn-label",l.dataset.i18n=t,l.textContent=a.i18n.t(t,n.label);const c=document.createElement("span");c.classList.add("mhacc-slider-items");const r=document.createElement("span");r.setAttribute("aria-live","polite"),r.classList.add("mhacc-slider-value");const d=document.createElement("button");d.type="button",d.setAttribute("role","button"),d.setAttribute("aria-label",n.label+" reduce"),d.classList.add("mhacc-slider-btn"),d.textContent="−",d.dataset.action="slider_change",d.dataset.feature=t,d.dataset.group=e.id,d.dataset.delta=-10;const u=document.createElement("button");u.type="button",u.setAttribute("role","button"),u.setAttribute("aria-label",n.label+" enlarge"),u.classList.add("mhacc-slider-btn"),u.textContent="+",u.dataset.action="slider_change",u.dataset.feature=t,u.dataset.group=e.id,u.dataset.delta=10,c.appendChild(d),c.appendChild(r),c.appendChild(u),i.appendChild(o),i.appendChild(l),i.appendChild(c);let g=a.storage.get(t,n.jsdefault??0);n.value=g,r.textContent=g,s.appendChild(i)}else if("select"==n.type){const i=document.createElement("button");i.type="button",i.className="mhacc-feature-btn-select",i.dataset.action="cycle_select",i.dataset.feature=t,i.dataset.group=e.id,i.ariaLabel=n.label||t,i.title=n.label||t,i.role="button";const o=document.createElement("span");o.classList.add("mhacc-btn-icon"),o.innerHTML=n.icon,i.appendChild(o);const l=document.createElement("span");l.className="mhacc-btn-label",l.dataset.i18n=t,l.textContent=a.i18n.t(t,n.label),i.appendChild(l);const c=document.createElement("span");c.classList.add("select-data-wrap"),Array.isArray(n.jsoptions)&&n.jsoptions.forEach((a=>{const i=document.createElement("span");a===n.value&&i.classList.add("is-active"),i.classList.add("select-data-wrap-item"),i.dataset.select=a,i.dataset.action="select_option",i.dataset.feature=t,i.dataset.group=e.id,i.dataset.select=a,c.appendChild(i)})),i.appendChild(c),s.appendChild(i)}})),n.appendChild(i),n.appendChild(s),t.appendChild(n)})))}},e.MHACC=a,document.addEventListener("DOMContentLoaded",(()=>{a.init()})),document.addEventListener("mhacc:feature",(()=>{a.applyFeatures(),a.applyFeatureEffects()}))}(window);